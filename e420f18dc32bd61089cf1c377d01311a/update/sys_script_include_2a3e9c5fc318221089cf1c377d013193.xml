<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_1596199_attend.GetLastCheckoutTime</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <mobile_callable>false</mobile_callable>
        <name>GetLastCheckoutTime</name>
        <sandbox_callable>false</sandbox_callable>
        <script><![CDATA[// var GetLastCheckoutTime = Class.create();
// GetLastCheckoutTime.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {

//     type: 'GetLastCheckoutTime'
// });
var GetLastCheckoutTime = Class.create();

function convertToIST(utcDateTime) {
    if (!utcDateTime) return "";
    var gdt = new GlideDateTime(utcDateTime);
    gdt.addSeconds(19800); // Convert UTC to IST (+5:30)
    return gdt.getValue();
}
GetLastCheckoutTime.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {

    getLastCheckOut: function() {
        var gr = new GlideRecord('x_1596199_attend_attendance_data');
        gr.addQuery('employee', gs.getUserID());
        gr.addNotNullQuery('check_out_time'); // Ensure checkout time exists
        gr.orderByDesc('sys_created_on'); // Fetch the latest record
        gr.query();

        if (gr.next()) {


            var checkOutTimeIST = convertToIST(gr.getValue('check_out_time'));
            return checkOutTimeIST;
        }
        return ""; // Return empty if no record found
    },

    type: 'GetLastCheckoutTime'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>truptibidave02</sys_created_by>
        <sys_created_on>2025-03-20 11:42:14</sys_created_on>
        <sys_id>2a3e9c5fc318221089cf1c377d013193</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>GetLastCheckoutTime</sys_name>
        <sys_package display_value="Attendance Management System" source="x_1596199_attend">e420f18dc32bd61089cf1c377d01311a</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Attendance Management System">e420f18dc32bd61089cf1c377d01311a</sys_scope>
        <sys_update_name>sys_script_include_2a3e9c5fc318221089cf1c377d013193</sys_update_name>
        <sys_updated_by>truptibidave02</sys_updated_by>
        <sys_updated_on>2025-03-21 07:12:43</sys_updated_on>
    </sys_script_include>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>2a3e9c5fc318221089cf1c377d013193</id>
        <sys_created_by>truptibidave02</sys_created_by>
        <sys_created_on>2025-03-20 11:42:13</sys_created_on>
        <sys_id>903f5c17c318221089cf1c377d013128</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>truptibidave02</sys_updated_by>
        <sys_updated_on>2025-03-20 11:42:13</sys_updated_on>
        <table>sys_script_include</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
